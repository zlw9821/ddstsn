[General]
network = DdsTsnNetwork
sim-time-limit = 3600s
scheduler-class = "inet::RealTimeScheduler"

# --- 外部 TAP 映射（保留你原有的 Emulation 设置） ---
# 让 host 的 eth[0] 绑定到宿主机的 tap 设备（tapa / tapb）
*.host1.eth[0].typename = "inet.emulation.linklayer.ethernet.ExtUpperEthernetInterface"
*.host1.eth[0].device = "tapa"
*.host1.eth[0].copyConfiguration = "copyFromExt"

*.host2.eth[0].typename = "inet.emulation.linklayer.ethernet.ExtUpperEthernetInterface"
*.host2.eth[0].device = "tapb"
*.host2.eth[0].copyConfiguration = "copyFromExt"

# IPv4 配置（简化：只为 host1/host2 指定地址）
*.configurator.config = xml("<config> \
  <interface hosts='host1' names='eth0' address='192.168.2.20' netmask='255.255.255.0'/> \
  <interface hosts='host2' names='eth0' address='192.168.2.21' netmask='255.255.255.0'/> \
</config>")

# 物理层速率（如需更改，在 NED 中改 Eth100M 或在这里修改）
**.eth*.bitrate = 100Mbps
**.duplexMode = true

**.crcMode = "computed"
**.fcsMode = "computed"
# --- TSN / Switch 参数 ---
# 使用自动扩展的连接语法 (ethg++)，无需指定 numPorts

# 如果你只想使用基本转发（先确保可以通信），保持下面两项为 false（默认）。
# 当需要试验 TAS / Qbv 时，把 hasEgressTrafficShaping 设为 true，并按 INET TAS 示例配置 gate schedule。
*.tsnSwitch.hasIngressTrafficFiltering = false
*.tsnSwitch.hasEgressTrafficShaping = false
*.tsnSwitch.hasFramePreemption = false
*.host1.hasFramePreemption = false
*.host2.hasFramePreemption = false

# --- 日志 / 可视化（按需打开） ---
*.visualizer.*.interfaceTableVisualizer.displayInterfaceTables = true
*.visualizer.*.interfaceTableVisualizer.nodeFilter = "not name=~tsnSwitch*"

# --- 应用层（示例：UDP pub/sub） ---
# 下面示例假设你用 UDPSourceApp / UDPSink 或你自己的 DDS 仿真应用
# 只示范如何在 ini 中配置简单 UDP 源/接收（用于功能验证）
*.host1.numApps = 1
*.host1.app[0].typename = "UdpBasicApp"          # 或你的 DDS 应用模块
*.host1.app[0].destAddresses = "192.168.2.21"
*.host1.app[0].destPort = 6000
*.host1.app[0].messageLength = 1200B
*.host1.app[0].sendInterval = 100ms

*.host2.numApps = 1
*.host2.app[0].typename = "UdpSinkApp"
*.host2.app[0].localPort = 6000

# --- 其他调试选项（按需开启） ---
# 记录 pcap（若使用 Emulation 接口，pcap 能帮助排查）
; **.recordPcap = true
